---
import DocsLayout from "../../layouts/DocsLayout.astro";
import SymbolTable from "../../components/SymbolTable.astro";
import CodeBlock from "../../components/CodeBlock.astro";
import { t, type Lang } from "../../i18n/translations";
import { symbolMap } from "../../data/symbols";

export function getStaticPaths() {
  return [{ params: { lang: "en" } }, { params: { lang: "ja" } }];
}

const { lang } = Astro.params as { lang: Lang };
const half = Math.ceil(symbolMap.length / 2);
const leftSymbols = symbolMap.slice(0, half);
const rightSymbols = symbolMap.slice(half);

const bt = "`";
const escapeExample = `^2^5^2 --> "^5"\n^7^5^7 --> '^5'\n^@^5^@ --> ${bt}^5${bt}`;
const templateExample = `^@^5^4^[^2Hello World!^2^]^@ --> ${bt}^5\${"Hello World!"}${bt}`;
const templateExprLabel =
  lang === "ja" ? "テンプレート式" : "Template expression";
---

<DocsLayout
  lang={lang}
  title={t(lang, "syntax.title") + "  NoShift.js"}
  currentPath={`/${lang}/syntax/`}
  prev={{
    href: `/${lang}/getting-started/`,
    title: t(lang, "nav.gettingStarted"),
  }}
  next={{ href: `/${lang}/capitalize/`, title: t(lang, "nav.capitalize") }}
>
  <h1>{t(lang, "syntax.title")}</h1>

  <h2>{t(lang, "syntax.introTitle")}</h2>
  <p set:html={t(lang, "syntax.introDesc")} />

  <h2>{t(lang, "syntax.tableTitle")}</h2>
  <div class="callout">
    <p>{t(lang, "syntax.tableNote")}</p>
  </div>
  <img
    src="https://raw.githubusercontent.com/otoneko1102/NoShift.js/refs/heads/main/my-keyboard.jpg"
    alt={lang === "ja" ? "開発者のキーボード" : "Developer's Keyboard"}
    class="keyboard-img"
  />
  <div class="symbol-grid">
    <SymbolTable
      headerShifted={t(lang, "syntax.tableShifted")}
      headerNoshift={t(lang, "syntax.tableNoshift")}
      symbols={leftSymbols}
    />
    <SymbolTable
      headerShifted={t(lang, "syntax.tableShifted")}
      headerNoshift={t(lang, "syntax.tableNoshift")}
      symbols={rightSymbols}
    />
  </div>
  <p>{templateExprLabel}: <code>^4^[</code> → <code>{"${"}</code></p>

  <h2>{t(lang, "syntax.capitalizeTitle")}</h2>
  <p set:html={t(lang, "syntax.capitalizeDesc")} />
  <CodeBlock
    lang="nsjs"
    code={`class ^3animal ^[\n  constructor^8name^9 ^[\n    this.name ^- name;\n  ^]\n^]`}
  />
  <p>{lang === "ja" ? "コンパイル後:" : "Compiles to:"}</p>
  <CodeBlock
    lang="javascript"
    code={`class Animal {\n  constructor(name) {\n    this.name = name;\n  }\n}`}
  />

  <h2>{t(lang, "syntax.commentTitle")}</h2>
  <p set:html={t(lang, "syntax.commentDesc")} />
  <CodeBlock
    lang="nsjs"
    code={`// line comment\n\n/^: block comment ^:/\n\n/^:\n  multi-line\n  block comment\n^:/`}
  />
  <p>{lang === "ja" ? "コンパイル後:" : "Compiles to:"}</p>
  <CodeBlock
    lang="javascript"
    code={`// line comment\n\n/* block comment */\n\n/*\n  multi-line\n  block comment\n*/`}
  />

  <h2>{t(lang, "syntax.escapeTitle")}</h2>
  <p set:html={t(lang, "syntax.escapeDesc")} />
  <CodeBlock lang="nsjs" code={escapeExample} />

  <h2>{t(lang, "syntax.templateTitle")}</h2>
  <p set:html={t(lang, "syntax.templateDesc")} />
  <CodeBlock lang="nsjs" code={templateExample} />

  <h2>{t(lang, "syntax.helloTitle")}</h2>
  <p>{t(lang, "syntax.helloInput")}</p>
  <CodeBlock lang="nsjs" code="console.log^8^2Hello World!^2^9;" />
  <p>{t(lang, "syntax.helloOutput")}</p>
  <CodeBlock lang="javascript" code={`console.log("Hello World!");`} />
</DocsLayout>
