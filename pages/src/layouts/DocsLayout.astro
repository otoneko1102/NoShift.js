---
import { Icon } from "astro-icon/components";
import BaseLayout from "./BaseLayout.astro";
import Sidebar from "../components/Sidebar.astro";
import PageNav from "../components/PageNav.astro";
import type { Lang } from "../i18n/translations";
import "../styles/global.css";

interface Props {
  lang: Lang;
  title?: string;
  description?: string;
  currentPath: string;
  prev?: { href: string; title: string };
  next?: { href: string; title: string };
}

const { lang, title, description, currentPath, prev, next } = Astro.props;
---

<BaseLayout lang={lang} title={title} description={description}>
  <div class="layout">
    <Sidebar lang={lang} currentPath={currentPath} />
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <div class="mobile-header">
      <button class="hamburger" id="hamburger" aria-label="Toggle menu">
        <Icon name="material-symbols:menu" />
      </button>
      <span class="mobile-title">NoShift.js</span>
    </div>

    <main class="main-content">
      <div class="content">
        <slot />
        {(prev || next) && <PageNav prev={prev} next={next} />}
      </div>
      <footer class="footer">
        <p>
          MIT License &copy; {new Date().getFullYear()}
          <a
            href="https://github.com/otoneko1102"
            target="_blank"
            rel="noopener">otoneko.</a
          >
        </p>
      </footer>
    </main>
  </div>

  <script>
    const hamburger = document.getElementById("hamburger");
    const sidebar = document.querySelector(".sidebar");
    const overlay = document.getElementById("sidebar-overlay");

    hamburger?.addEventListener("click", () => {
      sidebar?.classList.toggle("open");
      overlay?.classList.toggle("open");
    });

    overlay?.addEventListener("click", () => {
      sidebar?.classList.remove("open");
      overlay?.classList.remove("open");
    });
  </script>
</BaseLayout>
